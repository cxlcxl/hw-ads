(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25e1d330"],{4221:function(t,e,a){"use strict";var n=a("4b8d"),c=a("4f7e"),o=a("c7b3"),r=a("3978"),i=a("b821"),l=a("3e87"),s=a("e001"),u=a("837a");c("search",(function(t,e,a){return[function(e){var a=r(this),c=void 0==e?void 0:s(e,t);return c?n(c,e,a):new RegExp(e)[t](l(a))},function(t){var n=o(this),c=l(t),r=a(e,n,c);if(r.done)return r.value;var s=n.lastIndex;i(s,0)||(n.lastIndex=0);var d=u(n,c);return i(n.lastIndex,s)||(n.lastIndex=s),null===d?-1:d.index}]}))},5723:function(t,e,a){"use strict";a.d(e,"e",(function(){return c})),a.d(e,"b",(function(){return o})),a.d(e,"d",(function(){return r})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return l})),a.d(e,"j",(function(){return s})),a.d(e,"k",(function(){return u})),a.d(e,"g",(function(){return d})),a.d(e,"f",(function(){return m})),a.d(e,"i",(function(){return p})),a.d(e,"h",(function(){return f}));var n=a("b775");function c(t){return Object(n["a"])({url:"/account/update",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/account/create",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/account/list",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/account/"+t,method:"get"})}function l(t){return Object(n["a"])({url:"/account/auth",method:"get",params:{id:t}})}function s(t){return Object(n["a"])({url:"/account/refresh/"+t,method:"post"})}function u(t){return Object(n["a"])({url:"/account/search",method:"get",params:{account_name:t}})}function d(){return Object(n["a"])({url:"/account/default",method:"get"})}function m(){return Object(n["a"])({url:"/account/all",method:"get"})}function p(t){return Object(n["a"])({url:"/account/parents",method:"get",params:t})}function f(t){return Object(n["a"])({url:"/account/token",method:"post",data:t})}},"80f8":function(t,e,a){},b224:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",[a("el-col",{staticClass:"search-container",attrs:{span:24}},[a("el-form",{ref:"_search",attrs:{model:t.search,inline:"",size:"small"}},[a("el-form-item",[a("el-input",{staticClass:"w200",attrs:{clearable:"",placeholder:"账户名"},model:{value:t.search.account_name,callback:function(e){t.$set(t.search,"account_name",e)},expression:"search.account_name"}})],1),a("el-form-item",[a("el-select",{staticClass:"w130",model:{value:t.search.account_type,callback:function(e){t.$set(t.search,"account_type",e)},expression:"search.account_type"}},[a("el-option",{attrs:{label:"全部账户类型",value:0}}),t._l(t.account_types,(function(t,e){return a("el-option",{attrs:{label:t,value:Number(e)}})}))],2)],1),a("el-form-item",[a("el-select",{staticClass:"w100",model:{value:t.search.state,callback:function(e){t.$set(t.search,"state",e)},expression:"search.state"}},t._l(t.accountList.state,(function(t,e){return a("el-option",{attrs:{label:t,value:Number(e)}})})),1)],1),a("el-form-item",{attrs:{label:""}},[a("el-button",{staticClass:"item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.doSearch}},[t._v("查询")])],1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:t.add}},[t._v("添加账户")])],1),a("el-col",{attrs:{span:24}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadings.pageLoading,expression:"loadings.pageLoading"}],staticStyle:{"margin-top":"15px"},attrs:{data:t.accountList.list,"highlight-current-row":"",stripe:"",border:"",size:"mini"}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"账号名称","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:{"text-success":1===e.row.is_auth}},[t._v(t._s(e.row.account_name))])]}}])}),a("el-table-column",{attrs:{label:"账号类型",width:"100",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.account_types[e.row.account_type]))]}}])}),a("el-table-column",{attrs:{prop:"advertiser_id",label:"广告主ID",width:"160"}}),a("el-table-column",{attrs:{prop:"developer_id",label:"开发者ID",width:"160"}}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:0===e.row.state?"text-error":""},[t._v(t._s(t._f("stateFilter")(e.row.state,t.accountList.state)))])]}}])}),a("el-table-column",{attrs:{label:"ClientID",prop:"client_id",width:"120"}}),a("el-table-column",{attrs:{prop:"created_at",label:"添加时间",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeFormat")(e.row.created_at)))]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button-group",{staticClass:"table-operate"},[a("el-button",{attrs:{type:"primary",plain:""},nativeOn:{click:function(a){return a.preventDefault(),t.editRow(e.row.id)}}},[t._v("编辑")]),1===e.row.account_type?[1===e.row.is_auth?a("el-button",{attrs:{type:"primary",plain:""},nativeOn:{click:function(a){return a.preventDefault(),t.doRefresh(e.row.id)}}},[t._v("刷新")]):a("el-button",{attrs:{type:"primary",plain:""},nativeOn:{click:function(a){return a.preventDefault(),t.doAuth(e.row.id)}}},[t._v("认证")])]:t._e()],2)]}}])})],1)],1),a("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:24}},[a("page",{ref:"page",attrs:{page:t.search.page,total:t.accountList.total},on:{"current-change":t.handlePage,"size-change":t.handlePageSize}}),a("account-create",{ref:"accountCreate",attrs:{"account-types":t.account_types},on:{success:t.getAccountList}}),a("account-update",{ref:"accountUpdate",attrs:{"account-types":t.account_types},on:{success:t.getAccountList}})],1)],1)},c=[],o=(a("8300"),a("ea5b"),a("e551"),a("2ce8"),a("4221"),a("5723")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dialog-panel",{attrs:{title:"添加账户","confirm-text":"添加",visible:t.visible,"confirm-loading":t.loading},on:{cancel:t.cancel,confirm:t.add}},[a("el-form",{ref:"accountForm",attrs:{model:t.accountForm,"label-width":"120px",size:"small",rules:t.userRules}},[a("el-form-item",{attrs:{label:"账号名称",prop:"account_name"}},[a("el-input",{attrs:{placeholder:"请填写账号名称"},model:{value:t.accountForm.account_name,callback:function(e){t.$set(t.accountForm,"account_name",e)},expression:"accountForm.account_name"}})],1),a("el-form-item",{attrs:{label:"账号类型",prop:"account_type"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:t.accountForm.account_type,callback:function(e){t.$set(t.accountForm,"account_type",e)},expression:"accountForm.account_type"}},t._l(t.accountTypes,(function(t,e){return a("el-option",{attrs:{label:t,value:Number(e)}})})),1)],1),a("el-form-item",{attrs:{label:"广告主 ID",prop:"advertiser_id"}},[a("el-input",{attrs:{placeholder:"请填写广告主 ID"},model:{value:t.accountForm.advertiser_id,callback:function(e){t.$set(t.accountForm,"advertiser_id",e)},expression:"accountForm.advertiser_id"}})],1),a("el-form-item",{attrs:{label:"开发者 ID",prop:"developer_id"}},[a("el-input",{attrs:{placeholder:"请填写开发者 ID"},model:{value:t.accountForm.developer_id,callback:function(e){t.$set(t.accountForm,"developer_id",e)},expression:"accountForm.developer_id"}})],1),a("el-form-item",{attrs:{label:"ClientID",prop:"client_id"}},[a("el-input",{model:{value:t.accountForm.client_id,callback:function(e){t.$set(t.accountForm,"client_id",e)},expression:"accountForm.client_id"}})],1),a("el-form-item",{attrs:{label:"Secret",prop:"secret"}},[a("el-input",{model:{value:t.accountForm.secret,callback:function(e){t.$set(t.accountForm,"secret",e)},expression:"accountForm.secret"}})],1),a("el-form-item",{attrs:{prop:"parent_id",label:"上级账户"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",placeholder:"可输入名称查询","remote-method":t.remoteMethod,loading:t.remoteLoading},model:{value:t.accountForm.parent_id,callback:function(e){t.$set(t.accountForm,"parent_id",e)},expression:"accountForm.parent_id"}},t._l(t.accounts,(function(t){return a("el-option",{attrs:{label:t.account_name,value:Number(t.id)}})})),1)],1)],1)],1)},i=[],l=(a("4582"),a("041f"),a("d4fd")),s={components:{DialogPanel:l["a"]},props:{accountTypes:Object},data:function(){return{visible:!1,loading:!1,remoteLoading:!1,accountForm:{id:0,parent_id:0,account_name:"",advertiser_id:"",client_id:"",developer_id:"",secret:"",account_type:1,state:1},accounts:[],userRules:{account_name:{required:!0,message:"请填写账户名称"},account_type:{required:!0,message:"请选择账户类型"}}}},methods:{initCreate:function(){var t=this;Object(o["i"])().then((function(e){t.visible=!0,Array.isArray(e.data)?t.accounts=e.data:t.accounts=[],t.accounts.push({id:0,account_name:"无上级账户"})})).catch((function(e){t.$message.error("请求错误")}))},cancel:function(){this.$refs.accountForm.resetFields(),this.visible=!1},add:function(){var t=this;this.$refs.accountForm.validate((function(e){if(!e)return!1;t.loading=!0,t.$set(t.accountForm,"parent_id",Number(t.accountForm.parent_id)),Object(o["b"])(t.accountForm).then((function(e){t.$message.success("创建成功"),t.$emit("success"),t.loading=!1,t.cancel()})).catch((function(e){t.loading=!1,console.log(e)}))}))},remoteMethod:function(t){var e=this;""!==t.trim()?(this.remoteLoading=!0,Object(o["i"])({account_name:t}).then((function(t){e.remoteLoading=!1,Array.isArray(t.data)?e.accounts=t.data:e.accounts=[]})).catch((function(){e.remoteLoading=!1}))):this.options=[]}}},u=s,d=a("cba8"),m=Object(d["a"])(u,r,i,!1,null,null,null),p=m.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dialog-panel",{attrs:{title:"账户信息修改","confirm-text":"保存",visible:t.visible,"confirm-loading":t.loading},on:{cancel:t.cancel,confirm:t.save}},[a("el-form",{ref:"accountForm",attrs:{model:t.accountForm,"label-width":"120px",size:"small",rules:t.userRules}},[a("el-form-item",{attrs:{label:"账号名称",prop:"account_name"}},[a("el-input",{attrs:{placeholder:"请填写账号名称"},model:{value:t.accountForm.account_name,callback:function(e){t.$set(t.accountForm,"account_name",e)},expression:"accountForm.account_name"}})],1),a("el-form-item",{attrs:{label:"账号类型",prop:"account_type"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:t.accountForm.account_type,callback:function(e){t.$set(t.accountForm,"account_type",e)},expression:"accountForm.account_type"}},t._l(t.accountTypes,(function(t,e){return a("el-option",{attrs:{label:t,value:Number(e)}})})),1)],1),a("el-form-item",{attrs:{label:"状态",prop:"state"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.accountForm.state,callback:function(e){t.$set(t.accountForm,"state",e)},expression:"accountForm.state"}})],1),a("el-form-item",{attrs:{label:"广告主 ID",prop:"advertiser_id"}},[a("el-input",{attrs:{placeholder:"请填写广告主 ID"},model:{value:t.accountForm.advertiser_id,callback:function(e){t.$set(t.accountForm,"advertiser_id",e)},expression:"accountForm.advertiser_id"}})],1),a("el-form-item",{attrs:{label:"开发者 ID",prop:"developer_id"}},[a("el-input",{attrs:{placeholder:"请填写开发者 ID"},model:{value:t.accountForm.developer_id,callback:function(e){t.$set(t.accountForm,"developer_id",e)},expression:"accountForm.developer_id"}})],1),a("el-form-item",{attrs:{label:"ClientID",prop:"client_id"}},[a("el-input",{attrs:{disabled:t.lockSecret},model:{value:t.accountForm.client_id,callback:function(e){t.$set(t.accountForm,"client_id",e)},expression:"accountForm.client_id"}})],1),a("el-form-item",{attrs:{label:"Secret",prop:"secret"}},[a("el-input",{attrs:{disabled:t.lockSecret},model:{value:t.accountForm.secret,callback:function(e){t.$set(t.accountForm,"secret",e)},expression:"accountForm.secret"}})],1),a("el-form-item",{attrs:{prop:"parent_id",label:"上级账户"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"",placeholder:"可输入名称查询","remote-method":t.remoteMethod,loading:t.remoteLoading},model:{value:t.accountForm.parent_id,callback:function(e){t.$set(t.accountForm,"parent_id",e)},expression:"accountForm.parent_id"}},t._l(t.accounts,(function(e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:Number(e.id)!==Number(t.accountForm.id),expression:"Number(item.id) !== Number(accountForm.id)"}],attrs:{label:e.account_name,value:Number(e.id)}})})),1)],1)],1)],1)},h=[],g={components:{DialogPanel:l["a"]},props:{accountTypes:Object,provider:Object},data:function(){return{visible:!1,loading:!1,lockSecret:!1,remoteLoading:!1,accounts:[],accountForm:{id:0,parent_id:"",account_name:"",advertiser_id:"",client_id:"",is_auth:0,developer_id:"",secret:"",account_type:1,state:1},userRules:{account_name:{required:!0,message:"请填写账户名称"},account_type:{required:!0,message:"请选择账户类型"},state:{required:!0,message:"请选择"}}}},methods:{initUpdate:function(t){var e=this;Object(o["c"])(t).then((function(t){e.accountForm=t.data,e.getDefaultAccounts(e.accountForm.parent_id),e.visible=!0})).catch((function(){e.$message.error("用户信息请求错误")}))},getDefaultAccounts:function(t){var e=this;Object(o["i"])({parent_id:t}).then((function(t){Array.isArray(t.data)?e.accounts=t.data:e.accounts=[],e.accounts.push({id:0,account_name:"无上级账户"})})).catch((function(t){e.$message.error("账户信息请求错误")}))},cancel:function(){this.$refs.accountForm.resetFields(),this.visible=!1},save:function(){var t=this;this.$refs.accountForm.validate((function(e){if(!e)return!1;t.loading=!0,t.$set(t.accountForm,"parent_id",Number(t.accountForm.parent_id)),Object(o["e"])(t.accountForm).then((function(e){t.$message.success("修改成功"),t.$emit("success"),t.loading=!1,t.cancel()})).catch((function(e){t.loading=!1,console.log(e)}))}))},remoteMethod:function(t){var e=this;""!==t.trim()?(this.remoteLoading=!0,Object(o["i"])({account_name:t}).then((function(t){e.remoteLoading=!1,Array.isArray(t.data)?e.accounts=t.data:e.accounts=[]})).catch((function(){e.remoteLoading=!1}))):this.options=[]}}},b=g,_=Object(d["a"])(b,f,h,!1,null,null,null),v=_.exports,y=a("fc23"),F=a("ed08"),w={name:"AccountList",components:{AccountCreate:p,AccountUpdate:v,Page:y["a"]},data:function(){return{loadings:{pageLoading:!1},account_types:{},accountList:{total:0,list:[],state:{}},roles:[],search:{account_id:"",account_name:"",account_type:0,state:1,page:1,page_size:10}}},mounted:function(){this.getAccountList()},filters:{stateFilter:function(t,e){return e[t]},timeFormat:function(t){return Object(F["c"])(t)}},methods:{getAccountList:function(){var t=this;this.loadings.pageLoading=!0,Promise.all([]).then((function(e){Object(o["d"])(t.search).then((function(e){var a=e.data,n=a.list,c=a.total,o=a.types,r=a.state;t.accountList.list=n,t.accountList.total=c,t.account_types=o,t.accountList.state=r,t.loadings.pageLoading=!1})).catch((function(){t.loadings.pageLoading=!1}))})).catch((function(){t.loadings.pageLoading=!1}))},add:function(){this.$refs.accountCreate.initCreate()},editRow:function(t){this.$refs.accountUpdate.initUpdate(t)},doRefresh:function(t){var e=this;this.$confirm("确定刷新此账户的认证信息吗?","确认信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){e.loadings.pageLoading=!0,Object(o["j"])(t).then((function(t){e.loadings.pageLoading=!1,e.$message.success("刷新成功")})).catch((function(t){e.loadings.pageLoading=!1}))})).catch((function(){}))},doAuth:function(t){var e=this;this.$confirm("确认认证此账号么?","确认信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){e.loadings.pageLoading=!0,Object(o["a"])(t).then((function(t){e.loadings.pageLoading=!1,window.open(t.data)})).catch((function(t){e.loadings.pageLoading=!1}))})).catch((function(){}))},doSearch:function(){this.search.page=1,this.getAccountList()},handlePage:function(t){this.search.page=t,this.getAccountList()},handlePageSize:function(t){this.search.page_size=t,this.getAccountList()}}},x=w,$=Object(d["a"])(x,n,c,!1,null,null,null);e["default"]=$.exports},b821:function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},b9c3:function(t,e,a){"use strict";a("80f8")},d4fd:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:t.title,visible:t.visible,width:t.width,"append-to-body":"","modal-append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.visible=e}}},[t._t("default"),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:t.confirmLoading,icon:"el-icon-close"},on:{click:t.handleCancel}},[t._v("取消")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.confirmText,expression:"confirmText"}],attrs:{type:"primary",icon:"el-icon-check",loading:t.confirmLoading},on:{click:t.handleConfirm}},[t._v(t._s(t.confirmText))]),t._t("operate")],2)],2)},c=[],o={props:{confirmText:{default:"",type:String},title:{default:"",type:String},width:{default:"600px",type:String},confirmLoading:{default:!1,type:Boolean},visible:{default:!1,type:Boolean}},methods:{handleCancel:function(){this.$emit("cancel")},handleConfirm:function(){this.$emit("confirm")}}},r=o,i=(a("b9c3"),a("cba8")),l=Object(i["a"])(r,n,c,!1,null,null,null);e["a"]=l.exports},fc23:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.limit,total:t.total,"hide-on-single-page":"",layout:"prev, pager, next, jumper, total, sizes","prev-text":"上页","next-text":"下页","page-sizes":[10,15,20,30,40,50,100]},on:{"current-change":t.handlePage,"size-change":t.handleSizeChange}})},c=[],o=(a("4582"),{props:{page:{type:Number,default:1},total:{type:Number,default:0},limit:{type:Number,default:10}},methods:{handlePage:function(t){this.$emit("current-change",t)},handleSizeChange:function(t){this.$emit("size-change",t)}}}),r=o,i=a("cba8"),l=Object(i["a"])(r,n,c,!1,null,null,null);e["a"]=l.exports}}]);