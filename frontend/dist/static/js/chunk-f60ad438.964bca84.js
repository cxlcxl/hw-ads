(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f60ad438"],{"0cb7":function(e,t,i){"use strict";i("d57f")},"29ef":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loadings.pageLoading,expression:"loadings.pageLoading"}],attrs:{gutter:15}},[i("el-form",{ref:"adgroupForm",attrs:{model:e.adgroupForm,"label-width":"120px",size:"mini",rules:e.adgroupRules}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"所属计划",prop:"campaign_id",rules:{required:!0,message:"计划必需选择"}}},[i("el-input",{attrs:{value:e.campaign.campaign_name,disabled:""}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"推广产品",prop:"product_id",rules:{required:!0,message:"计划必需选择"}}},[i("el-input",{attrs:{value:e.campaign.app.app_name,disabled:""}})],1)],1),i("el-col",{attrs:{span:12}}),i("el-col",{staticStyle:{"border-top":"1px solid #e3e3e3"},attrs:{span:24}},[i("p",{staticStyle:{margin:"10px 0 8px 0"}},[i("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.addTab(e.editableTabsValue)}}},[e._v("添加任务")])],1),i("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-remove":e.removeTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.adgroupForm.adgroups,(function(t,a){return i("el-tab-pane",{key:t.tab_name,attrs:{label:t.adgroup_name,name:t.tab_name}},[i("el-form-item",{attrs:{label:"定向",prop:"targeting_package_id",prop:"adgroups."+a+".targeting_package_id",rules:{required:!0,message:"请选择定向"}}},[i("el-select",{staticStyle:{width:"380px"},attrs:{placeholder:"选择已有定向"},model:{value:t.targeting_package_id,callback:function(i){e.$set(t,"targeting_package_id",i)},expression:"__adgroup.targeting_package_id"}},e._l(e.targetings,(function(e){return i("el-option",{attrs:{label:e.targeting_name,value:e.targeting_id}})})),1),i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(i){return e.updateTargeting(t.tab_name,a)}}},[e._v("修改")]),i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(i){return e.createTargeting(t.tab_name,a)}}},[e._v("新建")]),i("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-document-copy",type:"primary"},on:{click:function(i){return e.copyTab(t.tab_name,a)}}},[e._v("拷贝此任务")])],1),i("el-form-item",{attrs:{label:"版位",prop:"creative_size_id",prop:"adgroups."+a+".creative_size_id",rules:{required:!0,message:"请选择版位"}}},[i("el-radio-group",{on:{change:function(i){return e.getPositionList(i,t.tab_name)}},model:{value:t.category,callback:function(i){e.$set(t,"category",i)},expression:"__adgroup.category"}},e._l(e.resources.creative_category,(function(t,a){return i("el-radio-button",{attrs:{label:a}},[e._v(e._s(t))])})),1),i("adgroup-creative-size",{directives:[{name:"show",rawName:"v-show",value:""!==t.category,expression:"__adgroup.category !== ''"}],ref:"creativeSize"+t.tab_name,refInFor:!0,attrs:{"creative-size-list":e.positionList[t.tab_name],"creative-size-id":t.creative_size_id},on:{"handle-change":e.handleSelectPosition}})],1),i("el-form-item",{attrs:{label:"投放日期",prop:"adgroups."+a+".adgroup_begin_date",rules:{required:!0,message:"请选择投放开始日期"}}},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择开始日期","value-format":"yyyy-MM-dd"},model:{value:t.adgroup_begin_date,callback:function(i){e.$set(t,"adgroup_begin_date",i)},expression:"__adgroup.adgroup_begin_date"}}),e._v(" - "),i("el-date-picker",{attrs:{type:"date",placeholder:"结束日期可不选","value-format":"yyyy-MM-dd"},model:{value:t.adgroup_end_date,callback:function(i){e.$set(t,"adgroup_end_date",i)},expression:"__adgroup.adgroup_end_date"}})],1),i("el-form-item",{attrs:{label:"出价",prop:"adgroups."+a+".price",rules:{required:!0,message:"请填写出价金额"}}},[0===Number(t.creative_size_id)?i("div",{staticStyle:{color:"#909399"}},[e._v("未选择版位与产品信息")]):i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadings.priceLoading,expression:"loadings.priceLoading"}]},[i("el-radio-group",{on:{change:function(i){return e.handleChangePriceType(i,t.creative_size_id,a)}},model:{value:t.price_type,callback:function(i){e.$set(t,"price_type",i)},expression:"__adgroup.price_type"}},e._l(e.resources.pricing,(function(a,n){return e.pricing[t.tab_name].includes(a)?i("el-radio-button",{attrs:{label:n}},[e._v(" "+e._s(a))]):e._e()})),1),i("div",{directives:[{name:"show",rawName:"v-show",value:""!==t.price_type,expression:"__adgroup.price_type !== ''"}],staticStyle:{margin:"5px 0 0 0"}},["PRICING_OCPC"!==t.price_type?i("div",[i("el-input-number",{staticClass:"w180",attrs:{min:e.minPrice,precision:2,controls:!1},model:{value:t.price,callback:function(i){e.$set(t,"price",i)},expression:"__adgroup.price"}}),i("span",{staticClass:"text-error",staticStyle:{"margin-left":"10px","font-size":"12px"}},[e._v("请填写不低于 "+e._s(e.minPrice)+" 的金额")])],1):i("div",{staticClass:"price-ocpc"},[i("p",{staticClass:"ocpc-item"},[i("span",{staticClass:"ocpc-item-label"},[e._v("转化名称")]),i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.tracking_id,callback:function(i){e.$set(t,"tracking_id",i)},expression:"__adgroup.tracking_id"}},e._l(e.trackings,(function(e){return i("el-option",{key:e.tracking_id,attrs:{label:e.effect_name,value:e.tracking_id}})})),1),i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{icon:"el-icon-refresh",plain:""},on:{click:e.refreshTracking}})],1),i("p",{staticClass:"ocpc-item"},[i("span",{staticClass:"ocpc-item-label"},[e._v("期望转化成本")]),i("el-input-number",{staticClass:"w130",attrs:{min:.01,max:10,precision:2,controls:!1},model:{value:t.conversion_cost,callback:function(i){e.$set(t,"conversion_cost",i)},expression:"__adgroup.conversion_cost"}})],1),i("p",{staticClass:"ocpc-item"},[i("span",{staticClass:"ocpc-item-label"},[e._v("学习期点击出价")]),i("el-input-number",{staticClass:"w130",attrs:{min:.01,max:10,precision:2,controls:!1},model:{value:t.price,callback:function(i){e.$set(t,"price",i)},expression:"__adgroup.price"}})],1)])])],1)]),i("el-form-item",{attrs:{label:"任务名称",prop:"adgroups."+a+".adgroup_name",rules:{required:!0,message:"请填写任务名称"}}},[i("el-input",{attrs:{placeholder:"限 100 字内的中英文、数字以及破折号 [ - ]"},model:{value:t.adgroup_name,callback:function(i){e.$set(t,"adgroup_name",i)},expression:"__adgroup.adgroup_name"}})],1),i("el-divider"),i("creative-select",{ref:"creativeSelect__"+t.tab_name,refInFor:!0})],1)})),1),i("el-divider"),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.confirmAdgroup}},[e._v("提交")]),i("el-button",{attrs:{icon:"el-icon-close"},on:{click:e.cancelCreate}},[e._v("取消创建")])],1)],1)],1),i("targeting-create",{ref:"targeting_create",on:{"handle-success":e.targetingCallback}})],1)},n=[],r=(i("8300"),i("ea5b"),i("e551"),i("4582"),i("60fe"),i("1444"),i("2ce8"),i("792c"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("drawer-panel",{attrs:{title:"创建定向","confirm-text":"创建",visible:e.visible,"confirm-loading":e.loading,width:"800px",direction:"ltr"},on:{cancel:e.cancel,confirm:e.add}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"targetingForm",attrs:{model:e.targetingForm,"label-width":"120px",size:"mini",rules:e.targetingRules}},[i("el-form-item",{attrs:{label:"定向包名称",prop:"targeting_name"}},[i("el-input",{attrs:{placeholder:"限 100 字内的中英文、数字以及破折号 [ - ]"},model:{value:e.targetingForm.targeting_name,callback:function(t){e.$set(e.targetingForm,"targeting_name",t)},expression:"targetingForm.targeting_name"}})],1),i("el-form-item",{attrs:{label:"地域",prop:"location"}},[i("el-radio-group",{model:{value:e.targetingForm.location,callback:function(t){e.$set(e.targetingForm,"location",t)},expression:"targetingForm.location"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("自定义地理位置")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.targetingForm.location,expression:"targetingForm.location === '1'"}],staticStyle:{"margin-top":"5px"}},[i("el-radio-group",{model:{value:e.targetingForm.location_type,callback:function(t){e.$set(e.targetingForm,"location_type",t)},expression:"targetingForm.location_type"}},[i("el-radio",{attrs:{label:"current"}},[e._v("当前在这里的人")]),i("el-radio",{attrs:{label:"residence"}},[e._v("常住在这里的人")])],1),i("div",{staticClass:"dictionary-location"},[i("el-button",{attrs:{plain:"",type:"primary",icon:"el-icon-plus"},on:{click:e.selectLocation}},[e._v("选择国家/地区")]),i("targeting-location",{ref:"location",attrs:{continents:e.targetingLocations.continents,countries:e.targetingLocations.countries},on:{"handle-select":e.locationSelector}}),i("targeting-location-view",{ref:"locationView",attrs:{countries:e.targetingLocations.countries},on:{"handle-change":e.locationChange}})],1)],1)],1),i("el-form-item",{attrs:{label:"运营商",prop:"carrier"}},[i("el-radio-group",{model:{value:e.targetingForm.carrier,callback:function(t){e.$set(e.targetingForm,"carrier",t)},expression:"targetingForm.carrier"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("自定义")])],1),i("el-cascader-panel",{directives:[{name:"show",rawName:"v-show",value:"1"===e.targetingForm.carrier,expression:"targetingForm.carrier === '1'"}],staticClass:"dictionary-transfer",attrs:{options:e.dictionaries.carrier,filterable:"",clearable:"",props:{multiple:!0}},model:{value:e.targetingForm.carriers,callback:function(t){e.$set(e.targetingForm,"carriers",t)},expression:"targetingForm.carriers"}})],1),i("el-form-item",{attrs:{label:"语言",prop:"language"}},[i("el-radio-group",{model:{value:e.targetingForm.language_check,callback:function(t){e.$set(e.targetingForm,"language_check",t)},expression:"targetingForm.language_check"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("自定义")])],1),i("el-transfer",{directives:[{name:"show",rawName:"v-show",value:"1"===e.targetingForm.language_check,expression:"targetingForm.language_check === '1'"}],staticClass:"dictionary-transfer",attrs:{props:{key:"value",label:"label"},data:e.dictionaries.language,titles:["待选列表","已选列表"]},model:{value:e.targetingForm.language,callback:function(t){e.$set(e.targetingForm,"language",t)},expression:"targetingForm.language"}})],1),i("el-form-item",{attrs:{label:"性别",prop:"gender"}},[i("el-radio-group",{model:{value:e.targetingForm.gender,callback:function(t){e.$set(e.targetingForm,"gender",t)},expression:"targetingForm.gender"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),e._l(e.dictionaries.gender,(function(t){return i("el-radio-button",{attrs:{label:t.value}},[e._v(e._s(t.label))])}))],2)],1),i("el-form-item",{attrs:{label:"年龄",prop:"age"}},[i("el-checkbox-group",{on:{change:function(t){return e.handleChange(t,"age")}},model:{value:e.targetingForm.age,callback:function(t){e.$set(e.targetingForm,"age",t)},expression:"targetingForm.age"}},[i("el-checkbox-button",{attrs:{label:""}},[e._v("不限")]),e._l(e.dictionaries.age,(function(t){return i("el-checkbox-button",{attrs:{label:t.value}},[e._v(e._s(t.label))])}))],2)],1),i("el-form-item",{attrs:{label:"APP 安装",prop:"installed_apps"}},[i("el-radio-group",{model:{value:e.targetingForm.installed_apps,callback:function(t){e.$set(e.targetingForm,"installed_apps",t)},expression:"targetingForm.installed_apps"}},[i("el-radio-button",{attrs:{label:"1"}},[e._v("已安装")]),i("el-radio-button",{attrs:{label:"0"}},[e._v("未安装")])],1)],1),i("el-form-item",{attrs:{label:"APP 行为",prop:"app_category"}},[i("el-radio-group",{model:{value:e.targetingForm.app_category,callback:function(t){e.$set(e.targetingForm,"app_category",t)},expression:"targetingForm.app_category"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("一个月内活跃")]),i("el-radio-button",{attrs:{label:"2"}},[e._v("已安装")]),i("el-radio-button",{attrs:{label:"3"}},[e._v("未安装")])],1),i("el-transfer",{directives:[{name:"show",rawName:"v-show",value:""!==e.targetingForm.app_category,expression:"targetingForm.app_category !== ''"}],staticClass:"dictionary-transfer",attrs:{props:{key:"value",label:"label"},data:e.dictionaries.app_category,titles:["待选列表","已选列表"]},model:{value:e.targetingForm.app_categories,callback:function(t){e.$set(e.targetingForm,"app_categories",t)},expression:"targetingForm.app_categories"}})],1),i("el-form-item",{attrs:{label:"APP 兴趣",prop:"app_interest"}},[i("el-radio-group",{model:{value:e.targetingForm.app_interest,callback:function(t){e.$set(e.targetingForm,"app_interest",t)},expression:"targetingForm.app_interest"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("兴趣不限")]),i("el-radio-button",{attrs:{label:"2"}},[e._v("中等兴趣")]),i("el-radio-button",{attrs:{label:"3"}},[e._v("高兴趣")])],1),i("el-cascader-panel",{directives:[{name:"show",rawName:"v-show",value:""!==e.targetingForm.app_interest,expression:"targetingForm.app_interest !== ''"}],staticClass:"dictionary-transfer",attrs:{options:e.dictionaries.app_interest,props:{multiple:!0}},model:{value:e.targetingForm.app_interests,callback:function(t){e.$set(e.targetingForm,"app_interests",t)},expression:"targetingForm.app_interests"}})],1),i("el-form-item",{attrs:{label:"设备",prop:"series_type"}},[i("el-radio-group",{model:{value:e.targetingForm.series_type,callback:function(t){e.$set(e.targetingForm,"series_type",t)},expression:"targetingForm.series_type"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("按品牌划分")])],1),i("el-transfer",{directives:[{name:"show",rawName:"v-show",value:"1"===e.targetingForm.series_type,expression:"targetingForm.series_type === '1'"}],staticClass:"dictionary-transfer",attrs:{props:{key:"value",label:"label"},data:e.dictionaries.series_type,titles:["待选列表","已选列表"]},model:{value:e.targetingForm.series,callback:function(t){e.$set(e.targetingForm,"series",t)},expression:"targetingForm.series"}})],1),i("el-form-item",{attrs:{label:"联网方式",prop:"network_type"}},[i("el-checkbox-group",{on:{change:function(t){return e.handleChange(t,"network_type")}},model:{value:e.targetingForm.network_type,callback:function(t){e.$set(e.targetingForm,"network_type",t)},expression:"targetingForm.network_type"}},[i("el-checkbox-button",{attrs:{label:""}},[e._v("不限")]),e._l(e.dictionaries.network_type,(function(t){return i("el-checkbox-button",{attrs:{label:t.value}},[e._v(e._s(t.label))])}))],2)],1),i("el-form-item",{attrs:{label:"自定义人群",prop:"audience"}},[i("el-radio-group",{model:{value:e.targetingForm.audience,callback:function(t){e.$set(e.targetingForm,"audience",t)},expression:"targetingForm.audience"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("自定义")])],1),i("el-row",{directives:[{name:"show",rawName:"v-show",value:"1"===e.targetingForm.audience,expression:"targetingForm.audience === '1'"}],staticClass:"dictionary-audience",attrs:{gutter:5}},[i("el-col",{attrs:{span:24}},[i("p",[e._v("包含人群")]),i("el-table",{ref:"audience",attrs:{data:e.dictionaries.pre_define_audience,size:"mini","max-height":"244px",border:""},on:{"selection-change":e.audienceSelectionChange}},[i("el-table-column",{attrs:{prop:"id",type:"selection",width:"50",align:"center",selectable:e.audienceSelectable}}),i("el-table-column",{attrs:{prop:"label",label:"人群包名称"}}),i("el-table-column",{attrs:{label:"覆盖量",width:"90",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("audienceNumFilter")(t.row.value)))]}}])})],1)],1),i("el-col",{attrs:{span:24}},[i("p",[e._v("排除人群")]),i("el-table",{ref:"not_audience",attrs:{data:e.dictionaries.not_pre_define_audience,size:"mini","max-height":"244px",border:""},on:{"selection-change":e.notAudienceSelectionChange}},[i("el-table-column",{attrs:{prop:"id",type:"selection",width:"50",align:"center",selectable:e.notAudienceSelectable}}),i("el-table-column",{attrs:{prop:"label",label:"人群包名称"}}),i("el-table-column",{attrs:{label:"覆盖量",width:"90",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("audienceNumFilter")(t.row.value)))]}}])})],1)],1)],1)],1),i("el-form-item",{attrs:{label:"媒体类型",prop:"media_app_category"}},[i("el-radio-group",{model:{value:e.targetingForm.media_app_category,callback:function(t){e.$set(e.targetingForm,"media_app_category",t)},expression:"targetingForm.media_app_category"}},[i("el-radio-button",{attrs:{label:""}},[e._v("不限")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("包含")])],1),i("el-cascader-panel",{directives:[{name:"show",rawName:"v-show",value:"1"===e.targetingForm.media_app_category,expression:"targetingForm.media_app_category === '1'"}],staticClass:"dictionary-transfer",attrs:{options:e.dictionaries.media_app_category,props:{multiple:!0}},model:{value:e.targetingForm.app_category_of_media,callback:function(t){e.$set(e.targetingForm,"app_category_of_media",t)},expression:"targetingForm.app_category_of_media"}})],1)],1)],1)}),s=[],c=(i("6770"),i("068b"),i("3bae"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-drawer",{attrs:{title:e.title,visible:e.visible,size:e.width,"append-to-body":"",direction:e.direction,wrapperClosable:!1,"show-close":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t}}},[i("div",{staticStyle:{padding:"0 15px 0 0"}},[e._t("default")],2),i("div",{staticStyle:{"text-align":"center"}},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.confirmText,expression:"confirmText"}],attrs:{type:"primary",icon:"el-icon-check",loading:e.confirmLoading},on:{click:e.handleConfirm}},[e._v(e._s(e.confirmText))]),i("el-button",{attrs:{loading:e.confirmLoading,icon:"el-icon-close"},on:{click:e.handleCancel}},[e._v("取消")])],1)])}),o=[],l={props:{confirmText:{default:"",type:String},title:{default:"",type:String},width:{default:"500px",type:String},confirmLoading:{default:!1,type:Boolean},visible:{default:!1,type:Boolean},direction:{default:"rtl",type:String}},methods:{handleCancel:function(){this.$emit("cancel")},handleConfirm:function(){this.$emit("confirm")}}},u=l,d=(i("63e3"),i("cba8")),p=Object(d["a"])(u,c,o,!1,null,null,null),g=p.exports,m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("drawer-panel",{attrs:{title:"国家/地区选择","confirm-text":"完成选择",visible:e.visible,"confirm-loading":e.loading,width:"550px"},on:{cancel:e.cancel,confirm:e.add}},[i("div",{staticClass:"location-selector"},[i("p",{staticClass:"location-search"},[i("el-input",{attrs:{placeholder:"请输入搜索国家/地区 - 切换大洲会自动过滤关键词",size:"small",clearable:""},on:{change:e.doSearch},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.doSearch},slot:"append"})],1)],1),i("el-tabs",{attrs:{type:"border-card"},model:{value:e.tabIdx,callback:function(t){e.tabIdx=t},expression:"tabIdx"}},[e._l(e.continents,(function(e){return i("el-tab-pane",{attrs:{label:e.c_name,name:e.id.toString()}})})),i("div",{staticClass:"location-table"},[i("p",{staticClass:"location-header"},[i("span",{staticClass:"location-item",staticStyle:{width:"300px"}},[e._v("国家/地区名")]),i("span",{staticClass:"location-item flex-item"},[i("el-tag",{attrs:{size:"mini",type:"success"},on:{click:e.includeAll}},[e._v("全部包含")])],1),i("span",{staticClass:"location-item flex-item"},[i("el-tag",{attrs:{size:"mini",type:"danger"},on:{click:e.excludeAll}},[e._v("全部排除")])],1)]),i("div",{staticClass:"location-body"},e._l(e.showSearch?e.searchList:e.countries,(function(t){return i("p",{directives:[{name:"show",rawName:"v-show",value:t.continent_id===Number(e.tabIdx),expression:"item.continent_id === Number(tabIdx)"}],staticClass:"location-line"},[i("span",{staticClass:"location-item",staticStyle:{width:"300px"}},[e._v(e._s(t.c_name))]),i("span",{staticClass:"location-item flex-item"},[i("el-tag",{directives:[{name:"show",rawName:"v-show",value:!e.selectorValue._include.includes(t.c_id),expression:"!selectorValue._include.includes(item.c_id)"}],attrs:{size:"mini",type:"success"},on:{click:function(i){return e.handleInclude(t.c_id)}}},[e._v("包含")])],1),i("span",{staticClass:"location-item flex-item"},[i("el-tag",{directives:[{name:"show",rawName:"v-show",value:!e.selectorValue._exclude.includes(t.c_id),expression:"!selectorValue._exclude.includes(item.c_id)"}],attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleExclude(t.c_id)}}},[e._v("排除")])],1)])})),0)])],2)],1)])},_=[],h=(i("eba8"),i("e157"),{components:{DrawerPanel:g},props:{continents:{type:Array,required:!0},countries:{type:Array,required:!0}},data:function(){return{visible:!1,loading:!1,showSearch:!1,tabIdx:"1",keyword:"",selectorValue:{_include:[],_exclude:[]},searchList:[]}},methods:{initCreate:function(e,t){this.continents.length>0&&(this.tabIdx=this.continents[0].id.toString()),Array.isArray(e)&&Array.isArray(t)?(this.$set(this.selectorValue,"_include",e),this.$set(this.selectorValue,"_exclude",t),this.visible=!0):this.$message.error("参数错误")},cancel:function(){this.visible=!1},add:function(){this.$emit("handle-select",this.selectorValue),this.visible=!1},handleInclude:function(e){var t=this.selectorIndexOf(this.selectorValue._exclude,e);-1!==t&&this.selectorValue._exclude.splice(t,1),this.selectorValue._include.push(e)},handleExclude:function(e){var t=this.selectorIndexOf(this.selectorValue._include,e);-1!==t&&this.selectorValue._include.splice(t,1),this.selectorValue._exclude.push(e)},includeAll:function(){for(var e=this.showSearch?this.searchList:this.countries,t=0;t<e.length;t++)if(Number(this.tabIdx)===e[t].continent_id){var i=e[t].c_id,a=this.selectorIndexOf(this.selectorValue._include,i);if(-1===a){var n=this.selectorIndexOf(this.selectorValue._exclude,i);-1!==n&&this.selectorValue._exclude.splice(n,1),this.selectorValue._include.push(i)}}},excludeAll:function(){for(var e=this.showSearch?this.searchList:this.countries,t=0;t<e.length;t++)if(Number(this.tabIdx)===e[t].continent_id){var i=e[t].c_id,a=this.selectorIndexOf(this.selectorValue._exclude,i);if(-1===a){var n=this.selectorIndexOf(this.selectorValue._include,i);-1!==n&&this.selectorValue._include.splice(n,1),this.selectorValue._exclude.push(i)}}},selectorIndexOf:function(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1},doSearch:function(){if(this.searchList=[],""!==this.keyword){for(var e=0;e<this.countries.length;e++){var t=this.countries[e].c_name;t.indexOf(this.keyword)>=0&&this.searchList.push(this.countries[e])}this.showSearch=!0}else this.showSearch=!1}}}),f=h,v=(i("6dd7"),Object(d["a"])(f,m,_,!1,null,null,null)),b=v.exports,y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-row",{attrs:{gutter:8}},[i("el-col",{staticClass:"location-view",attrs:{span:12}},[i("p",{staticClass:"location-header"},[i("span",{staticClass:"title text-success"},[e._v("包含列表")]),i("span",{staticClass:"item"},[i("el-tag",{attrs:{size:"mini",type:"danger"},on:{click:e.excludeAll}},[e._v("全部排除")])],1),i("span",{staticClass:"item"},[i("i",{staticClass:"el-icon-close text-error",on:{click:e.handleRemoveIncludeAll}})])]),i("div",{staticClass:"location-body"},e._l(e.countries,(function(t){return i("p",{directives:[{name:"show",rawName:"v-show",value:e.selectorValue._include.includes(t.c_id),expression:"selectorValue._include.includes(item.c_id)"}],staticClass:"location-line"},[i("span",{staticClass:"location-item",staticStyle:{width:"220px"}},[e._v(e._s(t.c_name))]),i("span",{staticClass:"location-item flex-item"},[i("el-tag",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleExclude(t.c_id)}}},[e._v("排除")])],1),i("span",{staticClass:"location-item flex-item"},[i("i",{staticClass:"el-icon-close text-error",on:{click:function(i){return e.handleRemoveInclude(t.c_id)}}})])])})),0)]),i("el-col",{staticClass:"location-view",attrs:{span:12}},[i("p",{staticClass:"location-header"},[i("span",{staticClass:"title text-error"},[e._v("排除列表")]),i("span",{staticClass:"item"},[i("el-tag",{attrs:{size:"mini",type:"success"},on:{click:e.includeAll}},[e._v("全部包含")])],1),i("span",{staticClass:"item"},[i("i",{staticClass:"el-icon-close text-error",on:{click:e.handleRemoveExcludeAll}})])]),i("div",{staticClass:"location-body"},e._l(e.countries,(function(t){return i("p",{directives:[{name:"show",rawName:"v-show",value:e.selectorValue._exclude.includes(t.c_id),expression:"selectorValue._exclude.includes(item.c_id)"}],staticClass:"location-line"},[i("span",{staticClass:"location-item",staticStyle:{width:"220px"}},[e._v(e._s(t.c_name))]),i("span",{staticClass:"location-item flex-item"},[i("el-tag",{attrs:{size:"mini",type:"success"},on:{click:function(i){return e.handleInclude(t.c_id)}}},[e._v("包含")])],1),i("span",{staticClass:"location-item flex-item"},[i("i",{staticClass:"el-icon-close text-error",on:{click:function(i){return e.handleRemoveExclude(t.c_id)}}})])])})),0)])],1)},x=[],k=(i("654b"),{props:{countries:{type:Array,required:!0}},data:function(){return{selectorValue:{_include:[],_exclude:[]}}},methods:{watchChange:function(e){this.$set(this.selectorValue,"_include",e._include),this.$set(this.selectorValue,"_exclude",e._exclude)},handleRemoveInclude:function(e){var t=this.selectorIndexOf(this.selectorValue._include,e);-1!==t&&this.selectorValue._include.splice(t,1),this.$emit("handle-change",this.selectorValue)},handleRemoveExclude:function(e){var t=this.selectorIndexOf(this.selectorValue._exclude,e);-1!==t&&this.selectorValue._exclude.splice(t,1),this.$emit("handle-change",this.selectorValue)},handleInclude:function(e){var t=this.selectorIndexOf(this.selectorValue._exclude,e);-1!==t&&this.selectorValue._exclude.splice(t,1),this.selectorValue._include.push(e),this.$emit("handle-change",this.selectorValue)},handleExclude:function(e){var t=this.selectorIndexOf(this.selectorValue._include,e);-1!==t&&this.selectorValue._include.splice(t,1),this.selectorValue._exclude.push(e),this.$emit("handle-change",this.selectorValue)},includeAll:function(){var e=this.selectorValue._include.concat(this.selectorValue._exclude);this.$set(this.selectorValue,"_include",e),this.$set(this.selectorValue,"_exclude",[]),this.$emit("handle-change",this.selectorValue)},excludeAll:function(){var e=this.selectorValue._include.concat(this.selectorValue._exclude);this.$set(this.selectorValue,"_include",[]),this.$set(this.selectorValue,"_exclude",e),this.$emit("handle-change",this.selectorValue)},handleRemoveExcludeAll:function(){this.$set(this.selectorValue,"_exclude",[]),this.$emit("handle-change",this.selectorValue)},handleRemoveIncludeAll:function(){this.$set(this.selectorValue,"_include",[]),this.$emit("handle-change",this.selectorValue)},selectorIndexOf:function(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1}}}),w=k,F=(i("fdad"),Object(d["a"])(w,y,x,!1,null,"c3686842",null)),C=F.exports,$=i("b775");function z(e){return Object($["a"])({url:"/marketing/targeting/create",method:"post",data:e})}function S(e){return Object($["a"])({url:"/marketing/targeting/list",method:"get",params:e})}function V(){return Object($["a"])({url:"/marketing/targeting/location",method:"get"})}function L(e){return Object($["a"])({url:"/marketing/dictionary/query",method:"get",params:e})}var T={name:"TargetingCreate",components:{DrawerPanel:g,TargetingLocation:b,TargetingLocationView:C},data:function(){return{visible:!1,loading:!1,remoteLoading:!1,adgroupIndex:0,targetingForm:{targeting_id:0,campaign_id:"",targeting_type:"",targeting_name:"",gender:"",age:[""],network_type:[""],location:"",location_type:"current",include_location:[],exclude_location:[],carrier:"",carriers:[],app_category:"",app_categories:[],app_interest:"",app_interests:[],audience:"",audiences:[],not_audience:[],series_type:"",series:[],media_app_category:"",app_category_of_media:[],language_check:"",language:[],installed_apps:"1"},defaultDictKeys:"age,series_type,network_type,gender,language,app_category,app_interest,media_app_category,carrier,pre_define_audience,not_pre_define_audience",targetingRules:{targeting_name:{required:!0,message:"请填写定向包名称"}},targetingLocations:{countries:[],continents:[]},creativeTab:"",dictionaries:{age:[],series_type:[],network_type:[],carrier:[],gender:[],language:[],app_category:[],app_interest:[],media_app_category:[],pre_define_audience:[],not_pre_define_audience:[]}}},filters:{audienceNumFilter:function(e){return Number(e)>0?(Number(e)/1e4).toFixed(0)+"万":e}},methods:{getLocationInfo:function(){var e=this;return new Promise((function(t,i){V().then((function(i){e.targetingLocations=i.data,t()})).catch((function(){e.$message.error("地域信息读取失败"),i()}))}))},initCreate:function(e,t,i,a){var n=this;this.adgroupIndex=a,Promise.all([this.getLocationInfo()]).then((function(){L({dict_key:n.defaultDictKeys}).then((function(a){if(n.dictionaries=a.data,n.creativeTab=e,n.visible=!0,i.hasOwnProperty("targeting_name")){if(n.loading=!0,n.$nextTick((function(){n.$refs.locationView.watchChange({_include:i.include_location,_exclude:i.exclude_location})})),n.targetingForm=i,n.loading=!1,Array.isArray(n.targetingForm.audiences)&&n.targetingForm.audiences.length>0)for(var r=function(e){n.targetingForm.audiences.includes(n.dictionaries.pre_define_audience[e].id)&&n.$nextTick((function(){n.$refs.audience.toggleRowSelection(n.dictionaries.pre_define_audience[e],!0)}))},s=0;s<n.dictionaries.pre_define_audience.length;s++)r(s);if(Array.isArray(n.targetingForm.not_audience)&&n.targetingForm.not_audience.length>0)for(var c=function(e){n.targetingForm.not_audience.includes(n.dictionaries.not_pre_define_audience[e].id)&&n.$nextTick((function(){n.$refs.not_audience.toggleRowSelection(n.dictionaries.not_pre_define_audience[e],!0)}))},o=0;o<n.dictionaries.not_pre_define_audience.length;o++)c(o)}else n.resetForm();n.$set(n.targetingForm,"campaign_id",t)})).catch((function(){n.$message.error("字典参数请求失败")}))})).catch((function(){}))},resetForm:function(){this.targetingForm={targeting_id:0,campaign_id:"",targeting_type:"",targeting_name:"",gender:"",age:[""],network_type:[""],location:"",location_type:"current",include_location:[],exclude_location:[],carrier:"",carriers:[],app_category:"",app_categories:[],app_interest:"",app_interests:[],audience:"",audiences:[],not_audience:[],series_type:"",series:[],media_app_category:"",app_category_of_media:[],language_check:"",language:[],installed_apps:"1"}},cancel:function(){this.resetForm(),this.visible=!1},add:function(){var e=this;this.$refs.targetingForm.validate((function(t){if(!t)return!1;e.loading=!0,z(e.targetingForm).then((function(t){e.loading=!1;var i=Object.assign({},e.targetingForm);i.targeting_id=t.data.targeting_id,e.$emit("handle-success",i,e.adgroupIndex),e.cancel()})).catch((function(){e.loading=!1})),e.$emit("success",e.creativeTab)}))},handleChange:function(e,t){if(e.length>1)if(""===e[e.length-1])this.$set(this.targetingForm,t,[""]);else{var i=[];e.forEach((function(e,t){""!==e&&i.push(e)})),this.$set(this.targetingForm,t,i)}},notAudienceSelectionChange:function(e){var t=[];e.forEach((function(e,i){t.push(e.id)})),this.$set(this.targetingForm,"not_audience",t)},audienceSelectionChange:function(e){var t=[];e.forEach((function(e,i){t.push(e.id)})),this.$set(this.targetingForm,"audiences",t)},audienceSelectable:function(e,t){return!1===this.targetingForm.not_audience.includes(e.id)},notAudienceSelectable:function(e,t){return!1===this.targetingForm.audiences.includes(e.id)},selectLocation:function(){this.$refs.location.initCreate(this.targetingForm.include_location,this.targetingForm.exclude_location)},locationSelector:function(e){this.$set(this.targetingForm,"include_location",e._include),this.$set(this.targetingForm,"exclude_location",e._exclude),this.$refs.locationView.watchChange(e)},locationChange:function(e){this.$set(this.targetingForm,"include_location",e._include),this.$set(this.targetingForm,"exclude_location",e._exclude)}}},O=T,I=(i("55a95"),Object(d["a"])(O,r,s,!1,null,null,null)),A=I.exports;function P(e){return Object($["a"])({url:"/marketing/position/query",method:"get",params:e})}function E(e){return Object($["a"])({url:"/marketing/position/price",method:"get",params:e})}function j(e){return Object($["a"])({url:"/marketing/position/category",method:"get"})}function N(e){return Object($["a"])({url:"/marketing/position/placement",method:"get",params:e})}var R=i("9afa"),q=i("3a06"),B=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.creativeLoading,expression:"creativeLoading"},{name:"show",rawName:"v-show",value:e.CreativeSizeList.length>0,expression:"CreativeSizeList.length > 0"}],attrs:{gutter:15}},[i("el-col",{attrs:{span:17}},[i("div",{staticClass:"creative-container"},e._l(e.CreativeSizeList,(function(t){return i("div",{class:{"creative-list":!0,"creative-active":t.creative_size_id===e.creative_size_id},on:{click:function(i){return e.handleChangeCreative(t)}}},[i("span",{staticClass:"creative-name"},[e._v(e._s(t.creative_size_name_dsp))]),i("span",{staticClass:"creative-desc"},[e._v(e._s(t.creative_size_description))])])})),0)]),i("el-col",{staticStyle:{background:"#99a9bf"},attrs:{span:7}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.creative_samples.length>0,expression:"creative_samples.length > 0"}],staticClass:"creative-banner"},[i("el-carousel",{attrs:{height:"255px"}},e._l(e.creative_samples,(function(t,a){return i("el-carousel-item",{key:a},[i("div",{staticClass:"banner-panel"},[i("p",[e._v(e._s(t.preview_title))]),i("img",{attrs:{src:t.creative_size_ample}})])])})),1)],1)])],1)},D=[],M=(i("42ca"),{props:{CreativeSizeList:{type:Array,required:!0},CreativeSizeId:{type:String,required:!0}},data:function(){return{creativeLoading:!1,creative_samples:[],creative_size_id:""}},mounted:function(){this.initComponent()},methods:{initComponent:function(){if(this.creative_size_id=this.CreativeSizeId,this.creative_size_id>0)for(var e=0;e<this.CreativeSizeList.length;e++)if(this.creative_size_id===this.CreativeSizeList[e].creative_size_id){this.creative_samples=this.CreativeSizeList[e].samples;break}},handleChangeCreative:function(e){var t=this;this.creative_size_id=e.creative_size_id,this.CreativeSizeId!==e.creative_size_id&&(this.creative_samples=Array.isArray(e.samples)?e.samples:[],N({creative_size_id:e.creative_size_id}).then((function(i){t.$emit("handle-change",t.creative_size_id,e.support_price_type.split(","),i.data)})).catch((function(){t.$emit("handle-change",t.creative_size_id,e.support_price_type.split(","),{})})))}}}),U=M,K=(i("b268"),Object(d["a"])(U,B,D,!1,null,"8550073e",null)),G=K.exports,J=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"selected"},{name:"loading",rawName:"v-loading",value:e.creativeLoading,expression:"creativeLoading"}],staticClass:"creative-select-container"},[i("p",{staticClass:"creative-title text-primary"},[e._v("创意素材选择")]),i("p",{staticClass:"creative-sub-type mt10"},[i("el-radio-group",{on:{change:e.handleChangeSubType},model:{value:e.element_search.sub_type,callback:function(t){e.$set(e.element_search,"sub_type",t)},expression:"element_search.sub_type"}},e._l(e.placement_sub_types.placements,(function(t,a){return i("el-radio-button",{attrs:{label:a}},[i("span",[e._v(e._s(e.placement_sub_types.sub_types[a]))]),i("span",{directives:[{name:"show",rawName:"v-show",value:e.creatives.hasOwnProperty(a)&&e.creatives[a].number>0,expression:"creatives.hasOwnProperty(label) && creatives[label].number > 0"}],staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.creatives[a].number))])])})),1)],1),i("div",{staticClass:"creative-opt"},[i("el-button",{attrs:{icon:"el-icon-plus",plain:"",disabled:e.creativesForm.length>=5},on:{click:e.addCreative}},[e._v("添加创意")]),e._l(e.creativesForm,(function(t,a){return t.sub_type===e.element_search.sub_type?i("span",{class:{"creative-item":!0,"creative-item-active":t.creative_index===e.active_creative_index}},[i("i",{on:{click:function(i){return e.changeCreative(t)}}},[e._v("创意 "+e._s(t.creative_index))]),i("i",{staticClass:"el-icon-copy-document text-info",on:{click:function(t){return e.copyCreative(a)}}}),i("i",{staticClass:"el-icon-delete text-error",on:{click:function(t){return e.removeCreative(a)}}})]):e._e()}))],2),i("p",{directives:[{name:"show",rawName:"v-show",value:e.creative_sizes.length>0,expression:"creative_sizes.length > 0"}],staticClass:"creative-size mt10"},[i("el-radio-group",{on:{change:e.handleChangeSize},model:{value:e.element_search.creative_size,callback:function(t){e.$set(e.element_search,"creative_size",t)},expression:"element_search.creative_size"}},e._l(e.creative_sizes,(function(t,a){return i("el-radio-button",{attrs:{label:t}},[e._v(e._s(t))])})),1)],1),i("el-form",{ref:"elementForm",staticClass:"creative-element",attrs:{"label-width":"120px",size:"mini",model:e.elementForm}},[e._l(e.elements,(function(t){return i("el-form-item",{attrs:{label:t.element_title,prop:t.element_name}},[["image","icon","video"].includes(t.element_name)?i("div",[e.assets[t.element_name].hasOwnProperty("asset_id")?i("div",{staticClass:"element-selected"},[i("p",{staticClass:"asset-remove",on:{click:function(i){return e.reselect(t.element_name)}}},[e._v("重新选择")]),["image","icon"].includes(t.element_name)?i("img",{staticClass:"asset",attrs:{src:e.assets[t.element_name].file_url}}):i("video",{staticClass:"asset",attrs:{type:e.assets[t.element_name].file_format,src:e.assets[t.element_name].file_url}})]):i("div",{staticClass:"element-upload",on:{click:function(i){return e.elementAsset(t)}}},[i("i",{staticClass:"el-icon-plus"}),i("p",{staticClass:"element-tip"},[e._v(e._s(t.width+"px * "+t.height+"px"))]),i("p",{staticClass:"element-tip"},[e._v(e._s(t.file_format))]),i("p",{staticClass:"element-tip"},[e._v("不超过 "+e._s(e._f("sizeLimitFilter")(t.file_size_kb_limit)))])]),i("position-element-asset",{ref:"elementAsset__"+t.element_id,refInFor:!0,attrs:{"element-type":t.element_name},on:{"confirm-select":e.selectedAsset}})],1):i("el-input",{attrs:{placeholder:t.element_caption},model:{value:e.elementForm[t.element_name],callback:function(i){e.$set(e.elementForm,t.element_name,i)},expression:"elementForm[__e.element_name]"}})],1)})),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.elements.length>0,expression:"elements.length > 0"}],attrs:{prop:"creative_name",label:"创意名称",rules:{required:!0,message:"请填写创意名称"}}},[i("el-input",{attrs:{placeholder:"请填写创意名称"},model:{value:e.elementForm.creative_name,callback:function(t){e.$set(e.elementForm,"creative_name",t)},expression:"elementForm.creative_name"}})],1)],2)],1)},H=[],Q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("dialog-panel",{attrs:{title:"素材选择","confirm-text":"确认选择",visible:e.visible,"confirm-loading":e.loading,width:"800px"},on:{cancel:e.cancel,confirm:e.confirm}},[i("div",{staticClass:"asset-box"},[i("ul",{staticClass:"asset-list"},e._l(e.assetList,(function(t){return i("li",{class:{"asset-item":!0,"asset-item-active":t.asset_id===e.asset.asset_id},on:{click:function(i){return e.handleSelect(t)}}},[i("p",{staticClass:"asset-title"},[e._v(e._s(t.asset_name))]),["image","icon"].includes(e.ElementType)?i("img",{staticClass:"asset-file",attrs:{src:t.file_url},on:{click:function(i){return e.showFile(t)}}}):i("video",{staticClass:"asset-file",attrs:{type:t.file_format,src:t.file_url},on:{click:function(i){return e.showFile(t)}}})])})),0)]),i("file-show",{ref:"fileShow"})],1)},W=[],X=i("530d"),Y=i("d4fd"),Z={props:{ElementType:{type:String,required:!0},ElementId:{type:String,default:""}},components:{DialogPanel:Y["a"],FileShow:X["a"]},data:function(){return{loading:!1,visible:!1,assetSearch:{asset_name:"",app_id:"",file_format:"",file_type:"",file_size_kb_limit:0,width:0,height:0},assetList:[],asset:{asset_id:0}}},methods:{initElementSelect:function(e,t){var i=this;this.assetSearch={app_id:t,file_format:e.file_format,file_size_kb_limit:e.file_size_kb_limit,width:e.width,height:e.height,file_type:e.element_name},Object(R["g"])(this.assetSearch).then((function(e){i.assetList=e.data,i.visible=!0})).catch((function(){}))},cancel:function(){this.visible=!1},confirm:function(){0!==this.asset.asset_id?(this.$emit("confirm-select",this.asset,this.ElementType),this.assetList=[],this.visible=!1):this.$message.error("请选择素材")},handleSelect:function(e){this.asset=e},showFile:function(e){this.$refs.fileShow.initPlay(e)}}},ee=Z,te=(i("2cd1"),Object(d["a"])(ee,Q,W,!1,null,"85517986",null)),ie=te.exports,ae={components:{PositionElementAsset:ie},data:function(){return{selected:!1,selectedSize:!1,creativeLoading:!1,app_id:"",placement_sub_types:{placements:{},sub_types:{}},element_search:{creative_size_id:"",sub_type:"",creative_size:""},creative_sizes:[],elements:[],creatives:{},headers:{},element_image:{},fileList:[],uploadUrl:"",elementForm:{creative_name:""},active_creative_index:1,creative_index:1,creativesForm:[],assets:{}}},filters:{acceptsFilter:function(e){return e},sizeLimitFilter:function(e){return e>1024?(e/1024).toFixed(2)+"MB":e+"KB"}},methods:{setPositionSubTypes:function(e,t,i){this.app_id=i,this.element_search.creative_size_id=t,this.creatives={},this.creative_sizes=[],this.elements=[],this.placement_sub_types=e;var a=!1;for(var n in e.placements)this.creatives[n]={number:0},a||(this.$set(this.element_search,"sub_type",n),this.$set(this.element_search,"creative_size",""),a=!0);this.selected=!0},handleChangeSubType:function(e){if(this.creativesForm.length>0)for(var t=0;t<this.creativesForm.length;t++)if(this.creativesForm[t].sub_type===e)return this.$set(this.element_search,"creative_size",this.creativesForm[t].creative_size),this.active_creative_index=this.creativesForm[t].creative_index,this.creative_sizes=this.placement_sub_types.placements[e],void(""!==this.creativesForm[t].creative_size&&this.fetchElements());this.creative_sizes=[],this.elements=[],this.$set(this.element_search,"creative_size","")},handleChangeSize:function(e){var t=this;this.setCreativeSubType(e),this.selectedSize?this.$confirm("将清除已填入的创意, 是否继续?","确认修改尺寸?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){t.fetchElements()})).catch((function(){})):this.fetchElements(),this.selectedSize=!0},setCreativeSubType:function(e){for(var t=0;t<this.creativesForm.length;t++)if(this.creativesForm[t].creative_index===this.active_creative_index){this.$set(this.creativesForm[t],"creative_size",e);break}},addCreative:function(){if(""!==this.element_search.sub_type){var e="";this.creative_sizes=this.placement_sub_types.placements[this.element_search.sub_type],1===this.creative_sizes.length?(this.element_search.creative_size=this.creative_sizes[0],e=this.creative_sizes[0],this.selectedSize=!0):this.selectedSize=!1;var t={creative_name:"",sub_type:this.element_search.sub_type,creative_index:this.creative_index,creative_size:e};this.creativesForm.push(t),this.changeCreative(t),this.creative_index++}else this.$message.error("请先选择版位形式")},changeCreative:function(e){this.active_creative_index=e.creative_index,this.$set(this.element_search,"creative_size",e.creative_size),this.$set(this.element_search,"sub_type",e.sub_type),this.creative_sizes=this.placement_sub_types.placements[e.sub_type],""!==e.creative_size&&this.fetchElements()},copyCreative:function(e){if(this.creativesForm.length>=5)this.$message.error("创意数量已达上线");else{var t=Object.assign({},this.creativesForm[e]);t.creative_index=this.creative_index,this.creative_index++,this.creativesForm.push(t),this.changeCreative(t)}},removeCreative:function(e){var t=this;this.$confirm("确认删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(t.creativesForm.splice(e,1),0===t.creativesForm.length)t.clearCreativeStatus();else{var i=t.creativesForm[t.creativesForm.length-1];t.active_creative_index=i.creative_index,t.$set(t.element_search,"creative_size",i.creative_size),t.$set(t.element_search,"sub_type",i.sub_type),t.creative_sizes=t.placement_sub_types.placements[i.sub_type],t.fetchElements()}})).catch((function(){}))},clearCreativeStatus:function(){this.creative_index=1,this.active_creative_index=1,this.creative_sizes=[],this.elements=[]},fetchElements:function(){var e=this;this.creativeLoading=!0,console.log("元素获取"),setTimeout((function(){e.creativeLoading=!1}),1e3)},elementAsset:function(e){this.$refs["elementAsset__"+e.element_id][0].initElementSelect(e,this.app_id)},selectedAsset:function(e,t){this.$set(this.elementForm,t,e.asset_id),this.$set(this.assets,t,e),console.log(this.assets,this.elementForm)},reselect:function(e){this.$set(this.elementForm,e,0),this.$set(this.assets,e,{})}}},ne=ae,re=(i("0cb7"),Object(d["a"])(ne,J,H,!1,null,"7d24ec34",null)),se=re.exports,ce={components:{TargetingCreate:A,AdgroupCreativeSize:G,CreativeSelect:se},data:function(){return{loadings:{pageLoading:!1,remoteAppLoading:!1,positionLoading:!1,priceLoading:!1},minPrice:0,targetings:[],trackings:[],campaign:{app:{}},positionList:{adgroup0:[]},pricing:{adgroup0:[]},editableTabsValue:"adgroup0",adgroupForm:{campaign_id:"",product_id:"",adgroups:[{tab_name:"adgroup0",adgroup_name:"任务 0",category:"",targeting_package_id:"",creative_size_id:"",adgroup_begin_date:"",adgroup_end_date:"",price_type:"",price:0,conversion_cost:0,tracking_id:0,creative:{}}]},adgroupRules:{},tabIndex:1,resources:{creative_category:{},pricing:{}}}},mounted:function(){this.getResources()},methods:{getPricing:function(){var e=this;return new Promise((function(t,i){Object(R["h"])().then((function(i){e.resources.pricing=i.data,t()})).catch((function(){e.$message.error("付费方式读取失败"),i()}))}))},getPositionCategory:function(){var e=this;return new Promise((function(t,i){j().then((function(i){e.resources.creative_category=i.data,t()})).catch((function(){e.$message.error("定向包列表读取失败"),i()}))}))},getCampaignInfo:function(){var e=this;return new Promise((function(t,i){Object(q["c"])(e.adgroupForm.campaign_id).then((function(i){e.campaign=i.data,e.campaign.app.hasOwnProperty("product_id")&&""!==e.campaign.app.product_id?e.$set(e.adgroupForm,"product_id",e.campaign.app.product_id):e.$message.error("产品信息未同步，请到应用列表拉取关联账户应用数据"),e.getTrackingList(e.campaign.app_id),t()})).catch((function(){e.$message.error("计划信息读取失败"),i()}))}))},getTrackingList:function(e){var t=this;Object(R["j"])({app_id:e}).then((function(e){t.trackings=e.data})).catch((function(){t.$message.error("转化跟踪列表读取失败")}))},getPositionList:function(e,t){var i=this;this.loadings.positionLoading=!0,P({category:e,account_id:this.campaign.account_id,product_type:this.campaign.product_type}).then((function(e){i.positionList[t]=e.data,i.loadings.positionLoading=!1})).catch((function(){i.positionList[t]=[],i.loadings.positionLoading=!1}))},getResources:function(){var e=this;this.loadings.pageLoading=!0,this.$route.query.hasOwnProperty("campaign_id")&&""!==this.$route.query.campaign_id?(this.$set(this.adgroupForm,"campaign_id",this.$route.query.campaign_id),Promise.all([this.getPricing(),this.getPositionCategory(),this.getCampaignInfo()]).then((function(){S({campaign_id:e.adgroupForm.campaign_id,account_id:e.campaign.account_id}).then((function(t){e.targetings=t.data,e.loadings.pageLoading=!1})).catch((function(){e.$message.error("定向包列表读取失败")}))})).catch((function(){e.loadings.pageLoading=!1}))):this.$message.error("计划参数错误，请重新进入此页面")},createTargeting:function(e,t){this.$refs.targeting_create.initCreate(e,this.adgroupForm.campaign_id,{},t)},updateTargeting:function(e,t){var i=Number(this.adgroupForm.adgroups[t].targeting_package_id);if(0!==i){for(var a={},n=0;n<this.targetings.length;n++)if(this.targetings[n].targeting_id===i){a=Object.assign({},this.targetings[n]),a.targeting_name="";break}this.$refs.targeting_create.initCreate(e,this.adgroupForm.campaign_id,a,t)}else this.$message.error("请先选择定向包")},targetingCallback:function(e,t){this.targetings.push(e),this.$set(this.adgroupForm.adgroups[t],"targeting_package_id",e.targeting_id)},handleSelectPosition:function(e,t,i){var a=this;this.$set(this.pricing,this.editableTabsValue,t),this.adgroupForm.adgroups.forEach((function(t,n){t.tab_name===a.editableTabsValue&&(a.$refs["creativeSelect__"+a.editableTabsValue][n].setPositionSubTypes(i,e,a.campaign.app_id),a.$set(a.adgroupForm.adgroups[n],"creative_size_id",e),a.$set(a.adgroupForm.adgroups[n],"price_type",""),a.$set(a.adgroupForm.adgroups[n],"price",0))}))},addTab:function(e){var t="adgroup"+this.tabIndex;this.adgroupForm.adgroups.push({tab_name:t,adgroup_name:"任务 "+this.tabIndex,category:"",targeting_package_id:"",creative_size_id:"",adgroup_begin_date:"",adgroup_end_date:"",price_type:"",price:0,conversion_cost:0,tracking_id:0,creative:{}}),this.editableTabsValue=t,this.setTabInfo(t,""),this.tabIndex++},copyTab:function(e,t){var i="adgroup"+this.tabIndex,a=Object.assign({},this.adgroupForm.adgroups[t]);a.tab_name=i,a.adgroup_name="任务 "+this.tabIndex,this.adgroupForm.adgroups.push(a),this.editableTabsValue=i,this.setTabInfo(i,e),this.tabIndex++},removeTab:function(e){var t=this;1!==this.adgroupForm.adgroups.length?this.$confirm("已填写的信息会丢失, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){var i=t.adgroupForm.adgroups,a=t.editableTabsValue;a===e&&i.forEach((function(t,n){if(t.tab_name===e){var r=0===n?i[n+1]:i[n-1];r&&(a=r.tab_name)}})),t.editableTabsValue=a,t.adgroupForm.adgroups=i.filter((function(t){return t.tab_name!==e})),t.setTabInfo(e,"")})).catch((function(){})):this.$message.error("不能删除最后一个任务")},setTabInfo:function(e,t){this.positionList[e]=""===t?[]:this.positionList[t],this.pricing[e]=""===t?[]:this.pricing[t]},handleChangePriceType:function(e,t,i){var a=this;this.loadings.priceLoading=!0,this.minPrice=0,this.$set(this.adgroupForm.adgroups[i],"price",0),E({creative_size_id:t,price_type:e}).then((function(e){a.minPrice=e.data,a.loadings.priceLoading=!1})).catch((function(){a.loadings.priceLoading=!1}))},refreshTracking:function(){var e=this;this.loadings.priceLoading=!0,Object(R["k"])({app_id:this.campaign.app_id}).then((function(t){e.trackings=t.data,e.loadings.priceLoading=!1})).catch((function(){e.$message.error("转化跟踪拉取失败"),e.loadings.priceLoading=!1}))},confirmAdgroup:function(){var e=this;this.$refs.adgroupForm.validate((function(t){if(!t)return!1;console.log(e.adgroupForm)}))},cancelCreate:function(){var e=this;this.$confirm("已填写的数据将会丢失, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){e.$store.dispatch("tagsView/delView",e.$route).then((function(){e.$router.replace({name:"CampaignList"})}))})).catch((function(){}))}}},oe=ce,le=(i("afc1"),Object(d["a"])(oe,a,n,!1,null,"68b66474",null));t["default"]=le.exports},"2cd1":function(e,t,i){"use strict";i("7b63")},"300a":function(e,t,i){},"3a06":function(e,t,i){"use strict";i.d(t,"d",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"e",(function(){return s})),i.d(t,"c",(function(){return c})),i.d(t,"a",(function(){return o}));var a=i("b775");function n(e){return Object(a["a"])({url:"/marketing/campaign/list",method:"get",params:e})}function r(e){return Object(a["a"])({url:"/marketing/campaign/create",method:"post",data:e})}function s(){return Object(a["a"])({url:"/marketing/campaign/resources",method:"get"})}function c(e){return Object(a["a"])({url:"/marketing/campaign/"+e,method:"get"})}function o(e){return Object(a["a"])({url:"/marketing/campaign/bind-app",method:"post",data:e})}},"42f6":function(e,t,i){},4514:function(e,t,i){},"530d":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("dialog-panel",{attrs:{title:"素材查看",visible:e.visible,"confirm-loading":e.loading,width:"1000px"},on:{cancel:e.cancel}},[i("p",{staticStyle:{margin:"0 0 10px 0",color:"#1890ff","font-weight":"600"}},[i("span",{directives:[{name:"show",rawName:"v-show",value:""!==e.file.app_id,expression:"file.app_id !== ''"}],staticStyle:{display:"inline-block","margin-right":"8px"}},[e._v("应用: "+e._s(e.file.app_id))]),e._v(" "+e._s(e.file.width+"*"+e.file.height+" / "+e.file.asset_name)+" ")]),i("div",{staticClass:"file-box"},["CREATIVE_ASSET_PICTURE"===e.file.asset_type?i("img",{staticClass:"preview__file",attrs:{src:e.file.file_url}}):i("video",{staticClass:"preview__file",attrs:{src:e.file.file_url,controls:"true"}})])])},n=[],r=i("d4fd"),s={components:{DialogPanel:r["a"]},data:function(){return{visible:!1,loading:!1,file:{app_id:"",asset_id:0,asset_name:"",asset_type:"CREATIVE_ASSET_PICTURE",file_format:"image/png",file_size:0,file_url:"",height:0,video_play_duration:0,width:0}}},methods:{initPlay:function(e){var t=this;this.file=e,setTimeout((function(){t.visible=!0}),200)},cancel:function(){this.visible=!1}}},c=s,o=(i("c1c3"),i("cba8")),l=Object(o["a"])(c,a,n,!1,null,"54f9c95c",null);t["a"]=l.exports},"55a95":function(e,t,i){"use strict";i("42f6")},6311:function(e,t,i){},"63e3":function(e,t,i){"use strict";i("8646")},"6dd7":function(e,t,i){"use strict";i("d001")},"7b63":function(e,t,i){},"80f8":function(e,t,i){},8646:function(e,t,i){},"9afa":function(e,t,i){"use strict";i.d(t,"h",(function(){return n})),i.d(t,"j",(function(){return r})),i.d(t,"k",(function(){return s})),i.d(t,"e",(function(){return c})),i.d(t,"i",(function(){return o})),i.d(t,"c",(function(){return l})),i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return d})),i.d(t,"d",(function(){return p})),i.d(t,"f",(function(){return g})),i.d(t,"g",(function(){return m}));var a=i("b775");function n(){return Object(a["a"])({url:"/marketing/resource/pricing",method:"get"})}function r(e){return Object(a["a"])({url:"/marketing/tracking/list",method:"get",params:e})}function s(e){return Object(a["a"])({url:"/marketing/tracking/refresh",method:"get",params:e})}var c=Object({VUE_APP_BASE_API:"https://hiads.mobgi.cc/api",NODE_ENV:"production",BASE_URL:""}).VUE_APP_MARKETING_API+"/marketing/asset/upload";function o(e){return Object(a["a"])({url:"/marketing/asset/sync",method:"get",params:e})}function l(e){return Object(a["a"])({url:"/marketing/asset/list",method:"get",params:e})}function u(e){return Object(a["a"])({url:"/marketing/asset/delete",method:"post",data:e})}function d(){return Object(a["a"])({url:"/marketing/asset/dimension",method:"get"})}function p(e){return Object(a["a"])({url:"/marketing/asset/token",method:"get",params:e})}function g(e){return Object(a["a"])({url:"/marketing/asset/bind",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/marketing/asset/element",method:"get",params:e})}},afc1:function(e,t,i){"use strict";i("6311")},b268:function(e,t,i){"use strict";i("dc4b")},b9c3:function(e,t,i){"use strict";i("80f8")},c1c3:function(e,t,i){"use strict";i("4514")},d001:function(e,t,i){},d4fd:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:e.title,visible:e.visible,width:e.width,"append-to-body":"","modal-append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.visible=t}}},[e._t("default"),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{loading:e.confirmLoading,icon:"el-icon-close"},on:{click:e.handleCancel}},[e._v("取消")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.confirmText,expression:"confirmText"}],attrs:{type:"primary",icon:"el-icon-check",loading:e.confirmLoading},on:{click:e.handleConfirm}},[e._v(e._s(e.confirmText))]),e._t("operate")],2)],2)},n=[],r={props:{confirmText:{default:"",type:String},title:{default:"",type:String},width:{default:"600px",type:String},confirmLoading:{default:!1,type:Boolean},visible:{default:!1,type:Boolean}},methods:{handleCancel:function(){this.$emit("cancel")},handleConfirm:function(){this.$emit("confirm")}}},s=r,c=(i("b9c3"),i("cba8")),o=Object(c["a"])(s,a,n,!1,null,null,null);t["a"]=o.exports},d57f:function(e,t,i){},dc4b:function(e,t,i){},fdad:function(e,t,i){"use strict";i("300a")}}]);